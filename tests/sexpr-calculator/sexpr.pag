lexer {
    definition DIGIT     = '0' .. '9';
    active token LPAREN     = '(';
    active token RPAREN     = ')';
    active token PLUS     = '+' | '加';
    active token MULT     = '*' | '乘';
    active token INT       = DIGIT+;
    silent token WHITESPACE = (' ' | '\t' | '\n' | '\r')+;
}

parser sexpr {
    active fixpoint compound
        = LPAREN ~ op ~ (compound | int)* ~ RPAREN;

    active definition op
        = PLUS | MULT;

    active definition int
        = INT;

    active definition sexpr
        = compound | int;
}
